<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekapan Data</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        table th, table td {
            vertical-align: middle;
        }
        .pagination {
            margin: 0;
        }
    </style>
</head>
<body>
<div class="container mt-4">

    <!-- Info Wali Kelas dan Dropdown Baris -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <strong>Nama Wali Kelas:</strong> <span id="userName">Admin</span><br>
            <strong>Kelas:</strong> <span id="userKelas">7A</span>
        </div>
        <div>
            <label for="rowsPerPage">Tampilkan</label>
            <select id="rowsPerPage" class="form-select d-inline-block w-auto">
                <option value="15">15</option>
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="100">100</option>
            </select>
            <span>baris</span>
        </div>
    </div>

    <!-- Search -->
    <div class="mb-3">
        <input type="text" id="searchInput" class="form-control" placeholder="Cari data...">
    </div>

    <!-- Table -->
    <table class="table table-striped table-bordered" id="dataTable">
        <thead class="table-dark">
        <tr>
            <th>Tanggal</th>
            <th>Mapel</th>
            <th>Nama Siswa</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>

    <!-- Pagination -->
    <nav>
        <ul class="pagination justify-content-center" id="pagination"></ul>
    </nav>
</div>

<script>
    // Sample data
    const data = [
        { Tanggal: "10/08/2025 7:01:04", Mapel: "Matematika", Nama: "Budi", Status: "Selesai" },
        { Tanggal: "09/08/2025 9:10:15", Mapel: "IPA", Nama: "Ani", Status: "Belum" },
        { Tanggal: "08/08/2025 13:45:20", Mapel: "Bahasa Indonesia", Nama: "Siti", Status: "Selesai" },
        { Tanggal: "10/08/2025 9:05:44", Mapel: "IPS", Nama: "Andi", Status: "Belum" }
    ];

    // Parse tanggal format "DD/MM/YYYY HH:MM:SS"
    function parseIndoDateTime(dateStr) {
        const [datePart, timePart] = dateStr.split(" ");
        const [day, month, year] = datePart.split("/").map(Number);
        let hours = 0, minutes = 0, seconds = 0;
        if (timePart) [hours, minutes, seconds] = timePart.split(":").map(Number);
        return new Date(year, month - 1, day, hours, minutes, seconds);
    }

    // Sorting data berdasarkan tanggal terbaru
    data.sort((a, b) => parseIndoDateTime(b.Tanggal) - parseIndoDateTime(a.Tanggal));

    let currentPage = 1;
    let rowsPerPage = 15;
    let filteredData = [...data];

    const tableBody = document.querySelector("#dataTable tbody");
    const pagination = document.getElementById("pagination");
    const searchInput = document.getElementById("searchInput");
    const rowsPerPageSelect = document.getElementById("rowsPerPage");

    function renderTable() {
        tableBody.innerHTML = "";
        let start = (currentPage - 1) * rowsPerPage;
        let end = start + rowsPerPage;
        let paginatedItems = filteredData.slice(start, end);

        paginatedItems.forEach(row => {
            let tr = document.createElement("tr");
            tr.innerHTML = `<td>${row.Tanggal}</td>
                            <td>${row.Mapel}</td>
                            <td>${row.Nama}</td>
                            <td>${row.Status}</td>`;
            tableBody.appendChild(tr);
        });
        renderPagination();
    }

    function renderPagination() {
        pagination.innerHTML = "";
        let pageCount = Math.ceil(filteredData.length / rowsPerPage);

        let prev = document.createElement("li");
        prev.className = `page-item ${currentPage === 1 ? "disabled" : ""}`;
        prev.innerHTML = `<a class="page-link" href="#">Prev</a>`;
        prev.onclick = () => { if (currentPage > 1) { currentPage--; renderTable(); }};
        pagination.appendChild(prev);

        for (let i = 1; i <= pageCount; i++) {
            let li = document.createElement("li");
            li.className = `page-item ${currentPage === i ? "active" : ""}`;
            li.innerHTML = `<a class="page-link" href="#">${i}</a>`;
            li.onclick = () => { currentPage = i; renderTable(); };
            pagination.appendChild(li);
        }

        let next = document.createElement("li");
        next.className = `page-item ${currentPage === pageCount ? "disabled" : ""}`;
        next.innerHTML = `<a class="page-link" href="#">Next</a>`;
        next.onclick = () => { if (currentPage < pageCount) { currentPage++; renderTable(); }};
        pagination.appendChild(next);
    }

    searchInput.addEventListener("input", function () {
        const searchTerm = this.value.toLowerCase();
        filteredData = data.filter(row =>
            row.Tanggal.toLowerCase().includes(searchTerm) ||
            row.Mapel.toLowerCase().includes(searchTerm) ||
            row.Nama.toLowerCase().includes(searchTerm) ||
            row.Status.toLowerCase().includes(searchTerm)
        );
        currentPage = 1;
        renderTable();
    });

    rowsPerPageSelect.addEventListener("change", function () {
        rowsPerPage = parseInt(this.value);
        currentPage = 1;
        renderTable();
    });

    renderTable();
</script>
</body>
</html>
