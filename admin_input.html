<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Data KBM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<!-- Navbar -->
<div id="navbar"></div>
<script>
    fetch("navbar_admin.html")
        .then(response => response.text())
        .then(data => document.getElementById("navbar").innerHTML = data);
</script>

<div class="container mt-4">
    <h3 class="mb-4">Form Input Data KBM</h3>

    <!-- Info Wali Kelas & Kelas -->
    <div class="mb-3">
        <div>Nama Wali Kelas: <span id="userName">Admin</span></div>
        <div>Kelas: <span id="userKelas">7A</span></div>
    </div>

    <!-- Form -->
    <form id="kbmForm" class="card p-3 shadow-sm">
        <div class="mb-3">
            <label for="tanggal" class="form-label">Tanggal</label>
            <input type="text" class="form-control" id="tanggal" name="tanggal" readonly>
        </div>

        <div class="mb-3">
            <label for="waliKelas" class="form-label">Wali Kelas</label>
            <input type="text" class="form-control" id="waliKelas" name="waliKelas" value="Admin" readonly>
        </div>

        <div class="mb-3">
            <label for="mapel" class="form-label">Mata Pelajaran</label>
            <select class="form-select" id="mapel" name="mapel" required>
                <option value="">Pilih Mata Pelajaran</option>
                <option>Matematika</option>
                <option>IPA</option>
                <option>IPS</option>
                <option>Bahasa Indonesia</option>
                <option>Bahasa Inggris</option>
            </select>
        </div>

        <div class="mb-3">
            <label for="kelas" class="form-label">Kelas</label>
            <input type="text" class="form-control" id="kelas" name="kelas" value="7A" readonly>
        </div>

        <div class="mb-3">
            <label for="namaSiswa" class="form-label">Nama Siswa</label>
            <select class="form-select" id="namaSiswa" name="namaSiswa" required>
                <option value="">Pilih Nama Siswa</option>
                <option>Andi</option>
                <option>Budi</option>
                <option>Citra</option>
                <option>Dewi</option>
            </select>
        </div>

        <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select class="form-select" id="status" name="status" required>
                <option value="">Pilih Status</option>
                <option>Selesai</option>
                <option>Belum</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary">Simpan</button>
    </form>
</div>

<script>
    // Set tanggal otomatis format dd/mm/yyyy hh:mm:ss
    function setTanggalNow() {
        let now = new Date();
        let day = String(now.getDate()).padStart(2, '0');
        let month = String(now.getMonth() + 1).padStart(2, '0');
        let year = now.getFullYear();
        let hours = String(now.getHours()).padStart(2, '0');
        let minutes = String(now.getMinutes()).padStart(2, '0');
        let seconds = String(now.getSeconds()).padStart(2, '0');
        document.getElementById('tanggal').value = `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
    }
    setTanggalNow();

    // Kirim data ke Google Apps Script
    document.getElementById('kbmForm').addEventListener('submit', function(e) {
        e.preventDefault();

        let formData = {
            tanggal: document.getElementById('tanggal').value,
            waliKelas: document.getElementById('waliKelas').value,
            mapel: document.getElementById('mapel').value,
            kelas: document.getElementById('kelas').value,
            namaSiswa: document.getElementById('namaSiswa').value,
            status: document.getElementById('status').value
        };

        fetch('YOUR_APPS_SCRIPT_WEBAPP_URL', {
            method: 'POST',
            mode: 'no-cors',
            body: JSON.stringify(formData)
        }).then(() => {
            alert('Data berhasil disimpan!');
            setTanggalNow(); // reset tanggal
            document.getElementById('kbmForm').reset();
        }).catch(err => {
            console.error(err);
            alert('Gagal menyimpan data.');
        });
    });
</script>

</body>
</html>
